
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Archive Quote</h3>
        <a class="navbar-triangle"></a>
    </div>
    <div class="panel-body ">

        <form name="archiveForm" class="form-horizontal" novalidate role="form">
            <div>

                <br />
                <div class="form-group" ng-class="{ 'has-error' : archiveForm.reference.$invalid && !archiveForm.reference.$pristine || (!quote.quoteValid && !archiveForm.reference.$pristine) }">
                    <label for="quote" class="col-xs-3 control-label">Quote: </label>
                    <div class="col-xs-8">


                        <input name="reference" autocomplete="off" required id="quote_reference" auto-complete ui-items="quote.quotesList" ng-change="quote.UpdateAutocomplete()"  ng-blur="quote.CheckQuote()" ng-model="quote.quote" maxlength="9" class="form-control input-sm" /><span class="mandatory-mark">*</span>
                        <p ng-show="archiveForm.reference.$invalid && !archiveForm.reference.$pristine" class="help-block">Quote Reference is required.</p>
                        <p ng-show="!quote.quoteValid && !archiveForm.reference.$pristine" class="help-block ">Quote Reference is not valid.</p>
                    </div>
                </div>


                <div class="form-group" ng-class="{ 'has-error' : archiveForm.reason.$invalid && !archiveForm.reason.$pristine }">
                    <label class="col-xs-3 control-label">Archive Reason: </label>
                    <div class="col-xs-8">
                        <select name="reason" required ng-model="quote.archive_reason" class="form-control input-sm">
                            <option ng-repeat="reason in quote.ntu_reasons" value="{{reason.ID}}">{{reason.Name}}</option>
                        </select><span class="mandatory-mark">*</span>
                        <p ng-show="archiveForm.reason.$invalid && !archiveForm.reason.$pristine" class="help-block">Archive Reason is required.</p>

                    </div>
                </div>


                <br />
                <br />

                <div class="form-group">
                    <div class="col-sm-7"></div>
                    <div class="col-sm-2">
                        <button ng-click="quote.Cancel()" class="btn btn-tiw-green btn-primary btn-block">Cancel</button>
                    </div>
                    <div class="col-sm-2">
                        <button ng-disabled="archiveForm.$invalid || !quote.quoteValid" ng-click="quote.Finish()" class="btn btn-tiw-green btn-primary btn-block">Finish</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
          //to avoid to use enter on text input and get back to the previous page as the cancel button always comes first
          $(document).ready(function () {
              $("#quote_reference").ForceStrictAlphaNumerics();
              angular.element("input:text").on("keypress", function (e) {
                  if (e.keyCode == 13) {
                      e.preventDefault();
                  }

              })

          })

</script>
